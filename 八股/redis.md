### **Redis 基础**

1. Redis 支持哪些数据结构？每种数据结构的应用场景是什么？
2. Redis 是单线程还是多线程的？为什么 Redis 速度快？
3. Redis 的过期策略有哪些？如何处理过期 key？
4. Redis 的淘汰策略有哪些？（LRU、LFU 等）
5. `KEYS` 命令和 `SCAN` 命令的区别是什么？为什么 `KEYS` 不推荐在生产环境使用？

------

### **Redis 持久化**

1. Redis 的持久化方式有哪几种？有什么区别？
2. RDB 和 AOF 分别适用于什么场景？
3. 如何修复 AOF 文件损坏的问题？
4. Redis 触发 RDB 快照的方式有哪些？
5. AOF 日志写入策略有哪几种？如何选择？

------

### **Redis 分布式**

1. Redis 主从复制的原理是什么？如何实现高可用？
2. 什么是 Redis 哨兵模式？如何保证 Redis 高可用？
3. Redis Cluster（集群模式）和 哨兵模式有什么区别？
4. Redis 集群是如何实现数据分片的？哈希槽（Hash Slot）的作用是什么？
5. Redis 集群如何处理节点故障？脑裂（Split-Brain）是什么，如何避免？

------

### **Redis 事务与并发**

1. Redis 事务如何实现？它具备原子性吗？
2. `MULTI`、`EXEC`、`WATCH` 的作用是什么？
3. `WATCH` 机制是如何保证事务安全的？
4. 为什么 Redis 事务不支持回滚？
5. Redis 事务和数据库事务（ACID）有什么不同？

------

### **Redis 高级特性**

1. 什么是 Redis 分布式锁？如何使用 `SETNX` 实现分布式锁？
2. Redis 分布式锁有什么缺陷？如何优化（如 RedLock 算法）？
3. 如何使用 Redis 实现秒杀系统？
4. Redis 如何防止缓存穿透、缓存击穿、缓存雪崩？
5. Redis 的 HyperLogLog 是什么？适用于哪些场景？

------

### **Redis 优化与面试场景**

1. Redis 如何进行性能优化？（管道 Pipeline、Lua 脚本、减少 `keys` 操作等）

2. 如果 Redis 负载过高，你有哪些优化措施？

3. Redis 如何支持 1000 万 QPS（高并发）？需要哪些优化手段？

4. 为什么 Redis 不适合作为数据库？适用于哪些业务场景？

5. 在生产环境中，如何监控 Redis 的运行状态？

   ======================

## redis各个数据类型的底层原理

String

采用sds简单动态字符串，里面还有字符串长度，分配的空间长度，sds类型，字节数组

不采用C++ 字符串的原因：

（1）可以o1获取字符串长度

（2）二进制安全 不需要用“\0"才判断结尾

（3）不会发生缓冲区溢出 redis会自动扩大sds分配空间

List

结点少的时候用ziplist，结点多的时候用双向链表

redis3.2之后统一用quickList（快速列表），由多个ziplist通过双向链表组成

hash：

结点少的时候是ziplist，节点多的时候是hashtable哈希表

redis7.0之后 ziplist被listpack代替

Set

节点少且元素均为整数都小于512的时候用intset，结点大的时候用hashtable

ZSet

结点少的时候用ziplist，结点多用跳表和字典。跳表用于排序，字典用于快速查询分值

## 什么是ziplist

ziplist就是一个单一连续内存块，上面记录整个大小和尾部的偏移量，字节的大小以供快速遍历下一个内存块

listpack就是ziplist的升级版，去掉了每个结点记录之前结点的长度，防止因为修改导致之后的结点也受影响

## Redis哈希表的扩容

当负载因子大于等于1的时候进行哈希扩容，会建立一个空间大小为哈希表1大小两倍的哈希表2，为了避免一次性迁移的阻塞，会分多批进行迁移。查询哈希的时候也是先对哈希表1进行查询，如果没有再查询哈希表2。

## Redis为什么快

1.大部分操作都在内存中完成

2.redis采用单线程模型可以避免多线程的竞争，省去多线程切换带来的时间和性能上的开销，同时也不会导致死锁

3.redis采用I/O多路复用机制，就是一个线程处理多个IO流

## redis的多线程

redis称之为单线程模式是执行数据是在一个线程里，但是后台日志更新，网络I/O读写是多线程，避免竞态造成的阻塞。

## 内存淘汰和过期删除

内存淘汰策略是在内存满了的时候，redis会触发内存淘汰机制，过期删除是将已过期的键值对进行删除。

内存淘汰主要分为两类：进行数据淘汰的策略，和不进行数据淘汰的策略